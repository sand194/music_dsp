---
title: "R_project_main"
author: "Jakub Piasek"
date: "2024-05-27"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set("~/ds/studia/sem2/r/r_project")
```


```{r cache=FALSE, echo=FALSE, results=FALSE}
library('lintr')

source("scraping.R", echo = T, local = knitr::knit_global())
knitr::read_chunk('scraping.R')
```


```{r scraping.R, eval=T}

```


Ilość rekordów we wszystkich ramkach danych

```{r}
total_rows <- ls() %>%
  set_names() %>%
  map(~ get(.)) %>%
  keep(is.data.frame) %>%
  map_int(nrow) %>%
  sum()


total_rows

total_rows > 30000
```

# Czyszczenie danych

### Usuwanie kolumny "Pos"
Aby uniknąć duplikatów w kolumnach, należy usunąć kolumnę "Pos"

```{r}
# List containing all of the data frames in Global Environment
data_frames <- ls() %>%
  set_names() %>%
  map(~ get(.)) %>%
  keep(is.data.frame)


dfs_affected <- c()


for (i in 1:length(data_frames)){
  
  current_df <- data_frames[[i]]
  
  
  if (grepl("Pos", names(current_df[1]))){
   
    current_df <- current_df %>%
      select(-c(names(current_df[1])))
    
    dfs_affected <- append(dfs_affected, names(data_frames[i]))
    
    data_frames[[i]] <- current_df
    
  }
 
}

# teraz podmienić wszystkie zmienione data framy

```


# TODO